from datetime import date
from importlib import resources
from platform import node
from site import execsitecustomize
import uuid
from venv import create

from numpy import var
from arches.app.models.models import Concept as modelConcept
from arches.app.models.concept import Concept
from arches.app.models.tile import Tile
from django.core.exceptions import ValidationError
from arches.app.functions.base import BaseFunction
import json

details = {
    "name": "Generate Node Value",
    "type": "node",
    "description": "Just a sample demonstrating node group selection",
    "defaultconfig": {"triggering_nodegroups": [],
                      "keys": { 
                            "RC_WALES_LKUP_WMAA_COMMUNITY_TEXT":"RC_WALES_LKUP_WMAA_COUNCIL_TEXT",
                            "Cefn Cribwr":"Bridgend",
                            "Pencoed":"Bridgend",
                            "Coychurch Lower":"Bridgend",
                            "Porthcawl":"Bridgend",
                            "Llangynwyd Lower":"Bridgend",
                            "Newcastle Higher":"Bridgend",
                            "Merthyr Mawr":"Bridgend",
                            "Coity Higher":"Bridgend",
                            "Laleston":"Bridgend",
                            "Coity Higher":"Bridgend",
                            "Coychurch Lower":"Bridgend",
                            "Coychurch Higher":"Bridgend",
                            "Ogmore Valley":"Bridgend",
                            "Cynffig":"Bridgend",
                            "Cynffig":"Bridgend",
                            "Pencoed":"Bridgend",
                            "Laleston":"Bridgend",
                            "St Brides Minor (Bridgend)":"Bridgend",
                            "Llangynwyd Middle":"Bridgend",
                            "Llangynwyd Lower":"Bridgend",
                            "Garw Valley":"Bridgend",
                            "Garw Valley":"Bridgend",
                            "Coychurch Higher":"Bridgend",
                            "St Brides Minor (Bridgend)":"Bridgend",
                            "Ynysawdre":"Bridgend",
                            "Bridgend":"Bridgend",
                            "Porthcawl":"Bridgend",
                            "Llangynwyd Middle":"Bridgend",
                            "Newcastle Higher":"Bridgend",
                            "Brackla":"Bridgend",
                            "Maesteg":"Bridgend",
                            "Bridgend":"Bridgend",
                            "Cefn Cribwr":"Bridgend",
                            "Brackla":"Bridgend",
                            "Ynysawdre":"Bridgend",
                            "Maesteg":"Bridgend",
                            "Ogmore Valley":"Bridgend",
                            "Merthyr Mawr":"Bridgend",
                            "Llanrhaeadr-ym-mochnant":"Powys",
                            "Llangynog (Powys)":"Powys",
                            "Yscir":"Powys",
                            "Llangyniew":"Powys",
                            "Llanwrtyd Wells":"Powys",
                            "Llangynidr":"Powys",
                            "Llanidloes":"Powys",
                            "Llanidloes Without":"Powys",
                            "Llanigon":"Powys",
                            "Llanwddyn":"Powys",
                            "Llansilin":"Powys",
                            "Llansantffraid":"Powys",
                            "Llangedwyn":"Powys",
                            "Ystradfellte":"Powys",
                            "Ystradgynlais":"Powys",
                            "Llanwrthwl":"Powys",
                            "Carno":"Powys",
                            "Dwyriw":"Powys",
                            "Llanidloes Without":"Powys",
                            "Llanigon":"Powys",
                            "Cilmery":"Powys",
                            "Churchstoke":"Powys",
                            "Clyro":"Powys",
                            "Carreghofa":"Powys",
                            "Llangynog (Powys)":"Powys",
                            "St Harmon":"Powys",
                            "Cadfarch":"Powys",
                            "Duhonw":"Powys",
                            "Bronllys":"Powys",
                            "Brecon":"Powys",
                            "Llanrhaeadr-ym-mochnant":"Powys",
                            "Castle Caereinion":"Powys",
                            "Abbey Cwmhir":"Powys",
                            "Llangurig":"Powys",
                            "Llangunllo":"Powys",
                            "Llangunllo":"Powys",
                            "Llangurig":"Powys",
                            "Llangors":"Powys",
                            "Llanidloes":"Powys",
                            "Llanyre":"Powys",
                            "Llangors":"Powys",
                            "Nantmel":"Powys",
                            "Disserth and Trecoed":"Powys",
                            "Llangynidr":"Powys",
                            "Llangyniew":"Powys",
                            "Crickhowell":"Powys",
                            "Cray":"Powys",
                            "Llangedwyn":"Powys",
                            "Llandinam":"Powys",
                            "Whitton":"Powys",
                            "Trallong":"Powys",
                            "Llanelwedd":"Powys",
                            "Llandyssil":"Powys",
                            "Llandysilio":"Powys",
                            "Llanfair Caereinion":"Powys",
                            "Llandrindod Wells":"Powys",
                            "Llanfechain":"Powys",
                            "Llanddewi Ystradenny":"Powys",
                            "Llanddew":"Powys",
                            "Trefeglwys":"Powys",
                            "Llanbrynmair":"Powys",
                            "Treflys":"Powys",
                            "Llanbister":"Powys",
                            "Llandrinio":"Powys",
                            "The Vale of Grwyney":"Powys",
                            "Rhayader":"Powys",
                            "Presteigne":"Powys",
                            "Penybont":"Powys",
                            "Talgarth":"Powys",
                            "Talybont-on-usk":"Powys",
                            "Llanerfyl":"Powys",
                            "Llangattock":"Powys",
                            "Tregynon":"Powys",
                            "Llangamarch":"Powys",
                            "Llanfyllin":"Powys",
                            "Llanfrynach":"Powys",
                            "Llanfihangel Rhydithon":"Powys",
                            "Llanfihangel Cwmdu with Bwlch and Cathedine":"Powys",
                            "Llanfihangel":"Powys",
                            "Tawe-uchaf":"Powys",
                            "Montgomery":"Powys",
                            "Pen-y-bont-fawr":"Powys",
                            "Painscastle":"Powys",
                            "Old Radnor":"Powys",
                            "Newtown and Llanllwchaiarn":"Powys",
                            "New Radnor":"Powys",
                            "Llanbadarn Fynydd":"Powys",
                            "Builth":"Powys",
                            "Forden":"Powys",
                            "Mochdre (Powys)":"Powys",
                            "Merthyr Cynog":"Powys",
                            "Meifod":"Powys",
                            "Manafon":"Powys",
                            "Maescar":"Powys",
                            "Machynlleth":"Powys",
                            "Welshpool":"Powys",
                            "Trewern":"Powys",
                            "Llywel":"Powys",
                            "Llanafanfawr":"Powys",
                            "Knighton":"Powys",
                            "Kerry":"Powys",
                            "Honddu Isaf":"Powys",
                            "Hay":"Powys",
                            "Erwood":"Powys",
                            "Guilsfield":"Powys",
                            "Felin-fach":"Powys",
                            "Glyn Tarell":"Powys",
                            "Glascwm":"Powys",
                            "Glasbury":"Powys",
                            "Glantwymyn":"Powys",
                            "Gladestry":"Powys",
                            "Llanbadarn Fawr (Powys)":"Powys",
                            "Gwernyfed":"Powys",
                            "Gwernyfed":"Powys",
                            "Llanafanfawr":"Powys",
                            "Merthyr Cynog":"Powys",
                            "Knighton":"Powys",
                            "Kerry":"Powys",
                            "Honddu Isaf":"Powys",
                            "Gladestry":"Powys",
                            "Hay":"Powys",
                            "Caersws":"Powys",
                            "Guilsfield":"Powys",
                            "Montgomery":"Powys",
                            "Glyn Tarell":"Powys",
                            "Glascwm":"Powys",
                            "Glasbury":"Powys",
                            "Manafon":"Powys",
                            "Mochdre (Powys)":"Powys",
                            "Llandrinio":"Powys",
                            "Llanfihangel Cwmdu with Bwlch and Cathedine":"Powys",
                            "Llanfihangel":"Powys",
                            "Llanfechain":"Powys",
                            "Llanfair Caereinion":"Powys",
                            "Llanerfyl":"Powys",
                            "Llanelwedd":"Powys",
                            "Llanbadarn Fawr (Powys)":"Powys",
                            "Llandysilio":"Powys",
                            "Llanbadarn Fynydd":"Powys",
                            "Llandrindod Wells":"Powys",
                            "Llandinam":"Powys",
                            "Llanddewi Ystradenny":"Powys",
                            "Llanddew":"Powys",
                            "Llanbister":"Powys",
                            "Forden":"Powys",
                            "Llandyssil":"Powys",
                            "Bettws (Powys)":"Powys",
                            "Caersws":"Powys",
                            "Cadfarch":"Powys",
                            "Builth":"Powys",
                            "Painscastle":"Powys",
                            "Bronllys":"Powys",
                            "Glantwymyn":"Powys",
                            "Pen-y-bont-fawr":"Powys",
                            "Carreghofa":"Powys",
                            "Berriew":"Powys",
                            "Beguildy":"Powys",
                            "Bausley with Criggion":"Powys",
                            "Banwy":"Powys",
                            "Aberhafesp":"Powys",
                            "Aberedw":"Powys",
                            "Brecon":"Powys",
                            "New Radnor":"Powys",
                            "Felin-fach":"Powys",
                            "Nantmel":"Powys",
                            "Erwood":"Powys",
                            "Dwyriw":"Powys",
                            "Duhonw":"Powys",
                            "Disserth and Trecoed":"Powys",
                            "Old Radnor":"Powys",
                            "Cray":"Powys",
                            "Carno":"Powys",
                            "Clyro":"Powys",
                            "Cilmery":"Powys",
                            "Newtown and Llanllwchaiarn":"Powys",
                            "Churchstoke":"Powys",
                            "Castle Caereinion":"Powys",
                            "Llanbrynmair":"Powys",
                            "Crickhowell":"Powys",
                            "St Harmon":"Powys",
                            "Tawe-uchaf":"Powys",
                            "Aberedw":"Powys",
                            "Trewern":"Powys",
                            "Abbey Cwmhir":"Powys",
                            "Llansantffraid":"Powys",
                            "Llanwrtyd Wells":"Powys",
                            "Llanwrthwl":"Powys",
                            "Ystradgynlais":"Powys",
                            "Ystradfellte":"Powys",
                            "Llansilin":"Powys",
                            "Llanyre":"Powys",
                            "Whitton":"Powys",
                            "Rhayader":"Powys",
                            "Welshpool":"Powys",
                            "Talgarth":"Powys",
                            "Talybont-on-usk":"Powys",
                            "Llanfihangel Rhydithon":"Powys",
                            "Meifod":"Powys",
                            "The Vale of Grwyney":"Powys",
                            "Llanwddyn":"Powys",
                            "Trallong":"Powys",
                            "Trefeglwys":"Powys",
                            "Treflys":"Powys",
                            "Tregynon":"Powys",
                            "Yscir":"Powys",
                            "Machynlleth":"Powys",
                            "Llanfrynach":"Powys",
                            "Llanfyllin":"Powys",
                            "Maescar":"Powys",
                            "Llangamarch":"Powys",
                            "Llangattock":"Powys",
                            "Bettws (Powys)":"Powys",
                            "Presteigne":"Powys",
                            "Berriew":"Powys",
                            "Llywel":"Powys",
                            "Penybont":"Powys",
                            "Bausley with Criggion":"Powys",
                            "Banwy":"Powys",
                            "Beguildy":"Powys",
                            "Aberhafesp":"Powys",
                            "Birchgrove":"Swansea",
                            "Penderry":"Swansea",
                            "Penllergaer":"Swansea",
                            "Cockett":"Swansea",
                            "Birchgrove":"Swansea",
                            "Bonymaen":"Swansea",
                            "Cockett":"Swansea",
                            "Clydach":"Swansea",
                            "Uplands":"Swansea",
                            "Bishopston":"Swansea",
                            "Sketty":"Swansea",
                            "Castle (Swansea)":"Swansea",
                            "Rhossili":"Swansea",
                            "Upper Killay":"Swansea",
                            "Reynoldston":"Swansea",
                            "Bonymaen":"Swansea",
                            "Pennard":"Swansea",
                            "Penrice":"Swansea",
                            "Port Eynon":"Swansea",
                            "Pontardulais":"Swansea",
                            "Pont-lliw":"Swansea",
                            "Castle (Swansea)":"Swansea",
                            "Clydach":"Swansea",
                            "Pennard":"Swansea",
                            "Llangyfelach":"Swansea",
                            "Port Eynon":"Swansea",
                            "Pontardulais":"Swansea",
                            "Mynyddbach":"Swansea",
                            "Mumbles":"Swansea",
                            "Morriston":"Swansea",
                            "Pont-lliw":"Swansea",
                            "Killay":"Swansea",
                            "Penrice":"Swansea",
                            "Reynoldston":"Swansea",
                            "Mawr":"Swansea",
                            "Penllergaer":"Swansea",
                            "Penderry":"Swansea",
                            "Llanrhidian Higher":"Swansea",
                            "Llanrhidian Lower":"Swansea",
                            "Llwchwr":"Swansea",
                            "Llansamlet":"Swansea",
                            "Bishopston":"Swansea",
                            "Dunvant":"Swansea",
                            "Dunvant":"Swansea",
                            "Townhill":"Swansea",
                            "Landore":"Swansea",
                            "Ilston":"Swansea",
                            "Cwmbwrla":"Swansea",
                            "St Thomas":"Swansea",
                            "Grovesend":"Swansea",
                            "Landore":"Swansea",
                            "Gorseinon":"Swansea",
                            "Killay":"Swansea",
                            "Gorseinon":"Swansea",
                            "Gowerton":"Swansea",
                            "Grovesend":"Swansea",
                            "Sketty":"Swansea",
                            "Llangennith":"Swansea",
                            "Rhossili":"Swansea",
                            "Ilston":"Swansea",
                            "Cwmbwrla":"Swansea",
                            "Gowerton":"Swansea",
                            "Mumbles":"Swansea",
                            "Llangennith":"Swansea",
                            "Mawr":"Swansea",
                            "Llansamlet":"Swansea",
                            "Townhill":"Swansea",
                            "Llanrhidian Lower":"Swansea",
                            "Morriston":"Swansea",
                            "St Thomas":"Swansea",
                            "Upper Killay":"Swansea",
                            "Mynyddbach":"Swansea",
                            "Llangyfelach":"Swansea",
                            "Uplands":"Swansea",
                            "Llwchwr":"Swansea",
                            "Llanrhidian Higher":"Swansea",
                            "Tredegar":"Blaenau Gwent",
                            "Cwm (Blaenau Gwent)":"Blaenau Gwent",
                            "Llanhilleth":"Blaenau Gwent",
                            "Abertillery":"Blaenau Gwent",
                            "Nantyglo and Blaina":"Blaenau Gwent",
                            "Brynmawr":"Blaenau Gwent",
                            "Brynmawr":"Blaenau Gwent",
                            "Llanhilleth":"Blaenau Gwent",
                            "Cwm (Blaenau Gwent)":"Blaenau Gwent",
                            "Beaufort":"Blaenau Gwent",
                            "Tredegar":"Blaenau Gwent",
                            "Beaufort":"Blaenau Gwent",
                            "Ebbw Vale":"Blaenau Gwent",
                            "Ebbw Vale":"Blaenau Gwent",
                            "Abertillery":"Blaenau Gwent",
                            "Nantyglo and Blaina":"Blaenau Gwent",
                            "Michaelston":"The Vale of Glamorgan",
                            "St Georges-super-ely":"The Vale of Glamorgan",
                            "Wick":"The Vale of Glamorgan",
                            "Llan-maes":"The Vale of Glamorgan",
                            "Barry":"The Vale of Glamorgan",
                            "St Nicholas and Bonvilston":"The Vale of Glamorgan",
                            "Rhoose":"The Vale of Glamorgan",
                            "Pendoylan":"The Vale of Glamorgan",
                            "Penllyn":"The Vale of Glamorgan",
                            "Peterston-super-ely":"The Vale of Glamorgan",
                            "St Athan":"The Vale of Glamorgan",
                            "St Brides Major (The Vale of Glamorgan)":"The Vale of Glamorgan",
                            "Penllyn":"The Vale of Glamorgan",
                            "St Donats":"The Vale of Glamorgan",
                            "Pendoylan":"The Vale of Glamorgan",
                            "Welsh St Donats":"The Vale of Glamorgan",
                            "St Georges-super-ely":"The Vale of Glamorgan",
                            "Wenvoe":"The Vale of Glamorgan",
                            "Sully":"The Vale of Glamorgan",
                            "Llanfair (The Vale of Glamorgan)":"The Vale of Glamorgan",
                            "Llandow":"The Vale of Glamorgan",
                            "Llantwit Major":"The Vale of Glamorgan",
                            "Peterston-super-ely":"The Vale of Glamorgan",
                            "Llandough":"The Vale of Glamorgan",
                            "Ewenny":"The Vale of Glamorgan",
                            "Llanfair (The Vale of Glamorgan)":"The Vale of Glamorgan",
                            "Llancarfan":"The Vale of Glamorgan",
                            "Sully":"The Vale of Glamorgan",
                            "Llangan":"The Vale of Glamorgan",
                            "Penarth":"The Vale of Glamorgan",
                            "Llancarfan":"The Vale of Glamorgan",
                            "Llantwit Major":"The Vale of Glamorgan",
                            "Llangan":"The Vale of Glamorgan",
                            "Wick":"The Vale of Glamorgan",
                            "Wenvoe":"The Vale of Glamorgan",
                            "Dinas Powys":"The Vale of Glamorgan",
                            "Llan-maes":"The Vale of Glamorgan",
                            "Michaelston":"The Vale of Glamorgan",
                            "Penarth":"The Vale of Glamorgan",
                            "Barry":"The Vale of Glamorgan",
                            "Ewenny":"The Vale of Glamorgan",
                            "St Athan":"The Vale of Glamorgan",
                            "St Brides Major (The Vale of Glamorgan)":"The Vale of Glamorgan",
                            "St Donats":"The Vale of Glamorgan",
                            "Welsh St Donats":"The Vale of Glamorgan",
                            "Rhoose":"The Vale of Glamorgan",
                            "Llandow":"The Vale of Glamorgan",
                            "St Nicholas and Bonvilston":"The Vale of Glamorgan",
                            "Llandough":"The Vale of Glamorgan",
                            "Colwinston":"The Vale of Glamorgan",
                            "Dinas Powys":"The Vale of Glamorgan",
                            "Colwinston":"The Vale of Glamorgan",
                            "Cowbridge with Llanblethian":"The Vale of Glamorgan",
                            "Cowbridge with Llanblethian":"The Vale of Glamorgan",
                            "Heath":"Cardiff",
                            "Fairwater (Cardiff)":"Cardiff",
                            "Tongwynlais":"Cardiff",
                            "Riverside":"Cardiff",
                            "Splott":"Cardiff",
                            "Cyncoed":"Cardiff",
                            "Old St Mellons":"Cardiff",
                            "Gabalfa":"Cardiff",
                            "St Fagans":"Cardiff",
                            "Roath":"Cardiff",
                            "Llanrumney":"Cardiff",
                            "Butetown":"Cardiff",
                            "Trowbridge":"Cardiff",
                            "Grangetown":"Cardiff",
                            "Rhiwbina":"Cardiff",
                            "Rumney":"Cardiff",
                            "Castle (Cardiff)":"Cardiff",
                            "Llanrumney":"Cardiff",
                            "Trowbridge":"Cardiff",
                            "Adamsdown":"Cardiff",
                            "Llanishen":"Cardiff",
                            "Caerau":"Cardiff",
                            "Whitchurch":"Cardiff",
                            "Llandaff":"Cardiff",
                            "Ely":"Cardiff",
                            "Tongwynlais":"Cardiff",
                            "Lisvane":"Cardiff",
                            "Llandaff North":"Cardiff",
                            "Whitchurch":"Cardiff",
                            "Canton":"Cardiff",
                            "Llanishen":"Cardiff",
                            "Cathays":"Cardiff",
                            "Roath":"Cardiff",
                            "Llandaff North":"Cardiff",
                            "Llandaff":"Cardiff",
                            "Pontprennau":"Cardiff",
                            "Lisvane":"Cardiff",
                            "Heath":"Cardiff",
                            "Grangetown":"Cardiff",
                            "Gabalfa":"Cardiff",
                            "Radyr":"Cardiff",
                            "Ely":"Cardiff",
                            "Rhiwbina":"Cardiff",
                            "Plasnewydd":"Cardiff",
                            "Riverside":"Cardiff",
                            "Fairwater (Cardiff)":"Cardiff",
                            "Cathays":"Cardiff",
                            "Castle (Cardiff)":"Cardiff",
                            "Rumney":"Cardiff",
                            "Canton":"Cardiff",
                            "Old St Mellons":"Cardiff",
                            "Caerau":"Cardiff",
                            "Butetown":"Cardiff",
                            "Splott":"Cardiff",
                            "Adamsdown":"Cardiff",
                            "St Fagans":"Cardiff",
                            "Cyncoed":"Cardiff",
                            "Pentwyn":"Cardiff",
                            "Radyr":"Cardiff",
                            "Pontprennau":"Cardiff",
                            "Pentyrch":"Cardiff",
                            "Plasnewydd":"Cardiff",
                            "Pentyrch":"Cardiff",
                            "Pentwyn":"Cardiff",
                            "Crosskeys":"Caerphilly",
                            "Rudry":"Caerphilly",
                            "Rudry":"Caerphilly",
                            "Cefn Fforest":"Caerphilly",
                            "Newbridge":"Caerphilly",
                            "New Tredegar":"Caerphilly",
                            "Penmaen":"Caerphilly",
                            "Darran Valley":"Caerphilly",
                            "Caerphilly":"Caerphilly",
                            "Rhymney":"Caerphilly",
                            "Crumlin":"Caerphilly",
                            "Penyrheol":"Caerphilly",
                            "Cefn Fforest":"Caerphilly",
                            "Nelson":"Caerphilly",
                            "Darran Valley":"Caerphilly",
                            "Crumlin":"Caerphilly",
                            "New Tredegar":"Caerphilly",
                            "Aber Valley":"Caerphilly",
                            "Abercarn":"Caerphilly",
                            "Gelligaer":"Caerphilly",
                            "Argoed":"Caerphilly",
                            "Pontllanfraith":"Caerphilly",
                            "Bargoed":"Caerphilly",
                            "Bedwas":"Caerphilly",
                            "Ynysddu":"Caerphilly",
                            "Newbridge":"Caerphilly",
                            "Llanbradach":"Caerphilly",
                            "Blackwood":"Caerphilly",
                            "Nelson":"Caerphilly",
                            "Rhymney":"Caerphilly",
                            "Caerphilly":"Caerphilly",
                            "Pengam":"Caerphilly",
                            "Crosskeys":"Caerphilly",
                            "Maesycwmmer":"Caerphilly",
                            "Van":"Caerphilly",
                            "Bedwas":"Caerphilly",
                            "Abercarn":"Caerphilly",
                            "Risca":"Caerphilly",
                            "Aber Valley":"Caerphilly",
                            "Risca":"Caerphilly",
                            "Ynysddu":"Caerphilly",
                            "Pontllanfraith":"Caerphilly",
                            "Argoed":"Caerphilly",
                            "Bargoed":"Caerphilly",
                            "Llanbradach":"Caerphilly",
                            "Maesycwmmer":"Caerphilly",
                            "Pengam":"Caerphilly",
                            "Van":"Caerphilly",
                            "Gelligaer":"Caerphilly",
                            "Penmaen":"Caerphilly",
                            "Blackwood":"Caerphilly",
                            "Penyrheol":"Caerphilly",
                            "Beechwood":"Newport",
                            "Llanvaches":"Newport",
                            "Nash":"Newport",
                            "Graig":"Newport",
                            "Goldcliff":"Newport",
                            "Marshfield":"Newport",
                            "Bishton":"Newport",
                            "Liswerry":"Newport",
                            "Bettws (Newport)":"Newport",
                            "Wentlooge":"Newport",
                            "Victoria":"Newport",
                            "Alway":"Newport",
                            "Gaer":"Newport",
                            "Llanwern":"Newport",
                            "Wentlooge":"Newport",
                            "Marshfield":"Newport",
                            "Stow Hill":"Newport",
                            "Victoria":"Newport",
                            "Allt-yr-yn":"Newport",
                            "Tredegar Park":"Newport",
                            "Coedkernew":"Newport",
                            "Nash":"Newport",
                            "Redwick":"Newport",
                            "Caerleon":"Newport",
                            "Penhow":"Newport",
                            "Gaer":"Newport",
                            "Coedkernew":"Newport",
                            "Bishton":"Newport",
                            "Malpas":"Newport",
                            "Goldcliff":"Newport",
                            "Shaftesbury":"Newport",
                            "Bettws (Newport)":"Newport",
                            "Michaelstone-y-fedw":"Newport",
                            "Beechwood":"Newport",
                            "Ringland":"Newport",
                            "Rogerstone":"Newport",
                            "Pillgwenlly":"Newport",
                            "Alway":"Newport",
                            "Llanvaches":"Newport",
                            "Llanwern":"Newport",
                            "Allt-yr-yn":"Newport",
                            "Michaelstone-y-fedw":"Newport",
                            "Malpas":"Newport",
                            "Langstone":"Newport",
                            "St Julians":"Newport",
                            "Caerleon":"Newport",
                            "Graig":"Newport",
                            "Ringland":"Newport",
                            "Liswerry":"Newport",
                            "Stow Hill":"Newport",
                            "Pillgwenlly":"Newport",
                            "Penhow":"Newport",
                            "Langstone":"Newport",
                            "Rogerstone":"Newport",
                            "St Julians":"Newport",
                            "Tredegar Park":"Newport",
                            "Redwick":"Newport",
                            "Shaftesbury":"Newport",
                            "Betws yn Rhos":"Conwy",
                            "Betws-y-coed":"Conwy",
                            "Bro Garmon":"Conwy",
                            "Bro Machno":"Conwy",
                            "Eglwysbach":"Conwy",
                            "Betws yn Rhos":"Conwy",
                            "Caerhun":"Conwy",
                            "Mochdre (Conwy)":"Conwy",
                            "Llannefydd":"Conwy",
                            "Llandudno":"Conwy",
                            "Bro Garmon":"Conwy",
                            "Llansannan":"Conwy",
                            "Rhos-on-sea":"Conwy",
                            "Dolwyddelan":"Conwy",
                            "Old Colwyn":"Conwy",
                            "Abergele":"Conwy",
                            "Henryd":"Conwy",
                            "Llansanffraid Glan Conwy":"Conwy",
                            "Llansannan":"Conwy",
                            "Mochdre (Conwy)":"Conwy",
                            "Ysbyty Ifan":"Conwy",
                            "Kinmel Bay and Towyn":"Conwy",
                            "Eglwysbach":"Conwy",
                            "Betws-y-coed":"Conwy",
                            "Llysfaen":"Conwy",
                            "Llansanffraid Glan Conwy":"Conwy",
                            "Llanrwst":"Conwy",
                            "Old Colwyn":"Conwy",
                            "Cerrigydrudion":"Conwy",
                            "Llannefydd":"Conwy",
                            "Llangernyw":"Conwy",
                            "Llangwm (Conwy)":"Conwy",
                            "Llangwm (Conwy)":"Conwy",
                            "Capel Curig":"Conwy",
                            "Colwyn Bay":"Conwy",
                            "Conwy":"Conwy",
                            "Llangernyw":"Conwy",
                            "Trefriw":"Conwy",
                            "Dolgarrog":"Conwy",
                            "Capel Curig":"Conwy",
                            "Ysbyty Ifan":"Conwy",
                            "Caerhun":"Conwy",
                            "Llanddoged and Maenan":"Conwy",
                            "Conwy":"Conwy",
                            "Colwyn Bay":"Conwy",
                            "Llanddulas and Rhyd-y-foel":"Conwy",
                            "Dolgarrog":"Conwy",
                            "Cerrigydrudion":"Conwy",
                            "Llanfair Talhaiarn":"Conwy",
                            "Llanfihangel Glyn Myfyr":"Conwy",
                            "Llanrwst":"Conwy",
                            "Bro Machno":"Conwy",
                            "Trefriw":"Conwy",
                            "Dolwyddelan":"Conwy",
                            "Llanddulas and Rhyd-y-foel":"Conwy",
                            "Penmaenmawr":"Conwy",
                            "Llanfair Talhaiarn":"Conwy",
                            "Abergele":"Conwy",
                            "Llysfaen":"Conwy",
                            "Henryd":"Conwy",
                            "Pentrefoelas":"Conwy",
                            "Llanfairfechan":"Conwy",
                            "Kinmel Bay and Towyn":"Conwy",
                            "Llanddoged and Maenan":"Conwy",
                            "Llanfairfechan":"Conwy",
                            "Penmaenmawr":"Conwy",
                            "Pentrefoelas":"Conwy",
                            "Llanfihangel Glyn Myfyr":"Conwy",
                            "Rhos-on-sea":"Conwy",
                            "Llandudno":"Conwy",
                            "Buan":"Gwynedd",
                            "Nefyn":"Gwynedd",
                            "Clynnog":"Gwynedd",
                            "Pennal":"Gwynedd",
                            "Corris":"Gwynedd",
                            "Llangywer":"Gwynedd",
                            "Criccieth":"Gwynedd",
                            "Llanbedr":"Gwynedd",
                            "Llanengan":"Gwynedd",
                            "Talsarnau":"Gwynedd",
                            "Pistyll":"Gwynedd",
                            "Llandygai":"Gwynedd",
                            "Llanllyfni":"Gwynedd",
                            "Pwllheli":"Gwynedd",
                            "Llanllechid":"Gwynedd",
                            "Llanystumdwy":"Gwynedd",
                            "Dyffryn Ardudwy":"Gwynedd",
                            "Mawddwy":"Gwynedd",
                            "Llanegryn":"Gwynedd",
                            "Dolbenmaen":"Gwynedd",
                            "Bryn-crug":"Gwynedd",
                            "Dolbenmaen":"Gwynedd",
                            "Y Felinheli":"Gwynedd",
                            "Maentwrog":"Gwynedd",
                            "Dolgellau":"Gwynedd",
                            "Llanelltyd":"Gwynedd",
                            "Porthmadog":"Gwynedd",
                            "Llangelynin":"Gwynedd",
                            "Pentir":"Gwynedd",
                            "Pentir":"Gwynedd",
                            "Llanbedrog":"Gwynedd",
                            "Clynnog":"Gwynedd",
                            "Llanberis":"Gwynedd",
                            "Llanuwchllyn":"Gwynedd",
                            "Penrhyndeudraeth":"Gwynedd",
                            "Llangywer":"Gwynedd",
                            "Llanfair (Gwynedd)":"Gwynedd",
                            "Llanllechid":"Gwynedd",
                            "Llanllyfni":"Gwynedd",
                            "Llannor":"Gwynedd",
                            "Llanfrothen":"Gwynedd",
                            "Llanrug":"Gwynedd",
                            "Llanfihangel-y-pennant":"Gwynedd",
                            "Aber":"Gwynedd",
                            "Maentwrog":"Gwynedd",
                            "Caernarfon":"Gwynedd",
                            "Harlech":"Gwynedd",
                            "Llandderfel":"Gwynedd",
                            "Waunfawr":"Gwynedd",
                            "Aberdovey":"Gwynedd",
                            "Brithdir and Llanfachreth":"Gwynedd",
                            "Aberdaron":"Gwynedd",
                            "Llanwnda":"Gwynedd",
                            "Penrhyndeudraeth":"Gwynedd",
                            "Criccieth":"Gwynedd",
                            "Llanddeiniolen":"Gwynedd",
                            "Llanystumdwy":"Gwynedd",
                            "Dyffryn Ardudwy":"Gwynedd",
                            "Llangelynin":"Gwynedd",
                            "Corris":"Gwynedd",
                            "Llanycil":"Gwynedd",
                            "Pennal":"Gwynedd",
                            "Dolgellau":"Gwynedd",
                            "Ganllwyd":"Gwynedd",
                            "Barmouth":"Gwynedd",
                            "Aberdaron":"Gwynedd",
                            "Aberdovey":"Gwynedd",
                            "Llanbedrog":"Gwynedd",
                            "Llanwnda":"Gwynedd",
                            "Llanelltyd":"Gwynedd",
                            "Aber":"Gwynedd",
                            "Bethesda":"Gwynedd",
                            "Arthog":"Gwynedd",
                            "Llanberis":"Gwynedd",
                            "Arthog":"Gwynedd",
                            "Bala":"Gwynedd",
                            "Llandwrog":"Gwynedd",
                            "Bangor":"Gwynedd",
                            "Caernarfon":"Gwynedd",
                            "Llanegryn":"Gwynedd",
                            "Harlech":"Gwynedd",
                            "Llanfair (Gwynedd)":"Gwynedd",
                            "Trawsfynydd":"Gwynedd",
                            "Llanrug":"Gwynedd",
                            "Llanaelhaearn":"Gwynedd",
                            "Barmouth":"Gwynedd",
                            "Bangor":"Gwynedd",
                            "Tudweiliog":"Gwynedd",
                            "Trawsfynydd":"Gwynedd",
                            "Waunfawr":"Gwynedd",
                            "Porthmadog":"Gwynedd",
                            "Llanbedr":"Gwynedd",
                            "Beddgelert":"Gwynedd",
                            "Y Felinheli":"Gwynedd",
                            "Llanengan":"Gwynedd",
                            "Ffestiniog":"Gwynedd",
                            "Talsarnau":"Gwynedd",
                            "Bala":"Gwynedd",
                            "Tywyn":"Gwynedd",
                            "Bontnewydd":"Gwynedd",
                            "Pwllheli":"Gwynedd",
                            "Ganllwyd":"Gwynedd",
                            "Botwnnog":"Gwynedd",
                            "Betws Garmon":"Gwynedd",
                            "Mawddwy":"Gwynedd",
                            "Llannor":"Gwynedd",
                            "Llandygai":"Gwynedd",
                            "Bryn-crug":"Gwynedd",
                            "Bontnewydd":"Gwynedd",
                            "Llandwrog":"Gwynedd",
                            "Buan":"Gwynedd",
                            "Botwnnog":"Gwynedd",
                            "Llanfihangel-y-pennant":"Gwynedd",
                            "Llanfrothen":"Gwynedd",
                            "Llanuwchllyn":"Gwynedd",
                            "Ffestiniog":"Gwynedd",
                            "Llandderfel":"Gwynedd",
                            "Tudweiliog":"Gwynedd",
                            "Pistyll":"Gwynedd",
                            "Llanddeiniolen":"Gwynedd",
                            "Beddgelert":"Gwynedd",
                            "Betws Garmon":"Gwynedd",
                            "Bethesda":"Gwynedd",
                            "Tywyn":"Gwynedd",
                            "Brithdir and Llanfachreth":"Gwynedd",
                            "Llanycil":"Gwynedd",
                            "Llanaelhaearn":"Gwynedd",
                            "Nefyn":"Gwynedd",
                            "Penydarren":"Merthyr Tydfil",
                            "Treharris":"Merthyr Tydfil",
                            "Town":"Merthyr Tydfil",
                            "Town":"Merthyr Tydfil",
                            "Cyfarthfa":"Merthyr Tydfil",
                            "Troed-y-rhiw":"Merthyr Tydfil",
                            "Vaynor":"Merthyr Tydfil",
                            "Gurnos":"Merthyr Tydfil",
                            "Bedlinog":"Merthyr Tydfil",
                            "Dowlais":"Merthyr Tydfil",
                            "Dowlais":"Merthyr Tydfil",
                            "Penydarren":"Merthyr Tydfil",
                            "Cyfarthfa":"Merthyr Tydfil",
                            "Merthyr Vale":"Merthyr Tydfil",
                            "Troed-y-rhiw":"Merthyr Tydfil",
                            "Treharris":"Merthyr Tydfil",
                            "Pant":"Merthyr Tydfil",
                            "Vaynor":"Merthyr Tydfil",
                            "Bedlinog":"Merthyr Tydfil",
                            "Pant":"Merthyr Tydfil",
                            "Park":"Merthyr Tydfil",
                            "Merthyr Vale":"Merthyr Tydfil",
                            "Park":"Merthyr Tydfil",
                            "Gurnos":"Merthyr Tydfil",
                            "Haverfordwest":"Pembrokeshire",
                            "Hayscastle":"Pembrokeshire",
                            "Johnston":"Pembrokeshire",
                            "Penally":"Pembrokeshire",
                            "Llanstadwell":"Pembrokeshire",
                            "Haverfordwest":"Pembrokeshire",
                            "Jeffreyston":"Pembrokeshire",
                            "Hayscastle":"Pembrokeshire",
                            "Templeton":"Pembrokeshire",
                            "Hundleton":"Pembrokeshire",
                            "Herbrandston":"Pembrokeshire",
                            "Pencaer":"Pembrokeshire",
                            "Pembroke Dock":"Pembrokeshire",
                            "Pembroke":"Pembrokeshire",
                            "Pembroke Dock":"Pembrokeshire",
                            "Manorbier":"Pembrokeshire",
                            "Pembroke":"Pembrokeshire",
                            "Mynachlog-ddu":"Pembrokeshire",
                            "St Florence":"Pembrokeshire",
                            "Boncath":"Pembrokeshire",
                            "Fishguard and Goodwick":"Pembrokeshire",
                            "Freystrop":"Pembrokeshire",
                            "Brawdy":"Pembrokeshire",
                            "Llanrhian":"Pembrokeshire",
                            "Manordeifi":"Pembrokeshire",
                            "Boncath":"Pembrokeshire",
                            "Narberth":"Pembrokeshire",
                            "Angle":"Pembrokeshire",
                            "Mynachlog-ddu":"Pembrokeshire",
                            "Ambleston":"Pembrokeshire",
                            "Nevern":"Pembrokeshire",
                            "New Moat":"Pembrokeshire",
                            "Letterston":"Pembrokeshire",
                            "Newport":"Pembrokeshire",
                            "Maenclochog":"Pembrokeshire",
                            "Walwyns Castle":"Pembrokeshire",
                            "Neyland":"Pembrokeshire",
                            "Nolton and Roch":"Pembrokeshire",
                            "Stackpole":"Pembrokeshire",
                            "St Dogmaels":"Pembrokeshire",
                            "Herbrandston":"Pembrokeshire",
                            "Penally":"Pembrokeshire",
                            "Amroth":"Pembrokeshire",
                            "Puncheston":"Pembrokeshire",
                            "Fishguard and Goodwick":"Pembrokeshire",
                            "Uzmaston and Boulston":"Pembrokeshire",
                            "Hundleton":"Pembrokeshire",
                            "Trecwn":"Pembrokeshire",
                            "Rosemarket":"Pembrokeshire",
                            "Rudbaxton":"Pembrokeshire",
                            "Ambleston":"Pembrokeshire",
                            "Saundersfoot":"Pembrokeshire",
                            "Scleddau":"Pembrokeshire",
                            "Llanddewi Velfrey":"Pembrokeshire",
                            "Tiers Cross":"Pembrokeshire",
                            "The Havens":"Pembrokeshire",
                            "Tenby":"Pembrokeshire",
                            "Wolfscastle":"Pembrokeshire",
                            "Amroth":"Pembrokeshire",
                            "Spittal":"Pembrokeshire",
                            "Freystrop":"Pembrokeshire",
                            "Angle":"Pembrokeshire",
                            "Slebech":"Pembrokeshire",
                            "Solva":"Pembrokeshire",
                            "Stackpole":"Pembrokeshire",
                            "St Mary Out Liberty":"Pembrokeshire",
                            "Spittal":"Pembrokeshire",
                            "St Ishmaels":"Pembrokeshire",
                            "St Florence":"Pembrokeshire",
                            "Kilgetty-begelly":"Pembrokeshire",
                            "St Dogmaels":"Pembrokeshire",
                            "St Davids and the Cathedral Close":"Pembrokeshire",
                            "Templeton":"Pembrokeshire",
                            "Solva":"Pembrokeshire",
                            "St Davids and the Cathedral Close":"Pembrokeshire",
                            "Merlins Bridge":"Pembrokeshire",
                            "Wiston":"Pembrokeshire",
                            "Marloes and St Brides":"Pembrokeshire",
                            "Kilgetty-begelly":"Pembrokeshire",
                            "Milford Haven":"Pembrokeshire",
                            "Pencaer":"Pembrokeshire",
                            "St Ishmaels":"Pembrokeshire",
                            "Llawhaden":"Pembrokeshire",
                            "Puncheston":"Pembrokeshire",
                            "Lampeter Velfrey":"Pembrokeshire",
                            "Lamphey":"Pembrokeshire",
                            "Mathry":"Pembrokeshire",
                            "Walwyns Castle":"Pembrokeshire",
                            "Llandissilio West":"Pembrokeshire",
                            "East Williamston":"Pembrokeshire",
                            "Uzmaston and Boulston":"Pembrokeshire",
                            "The Havens":"Pembrokeshire",
                            "Jeffreyston":"Pembrokeshire",
                            "Lamphey":"Pembrokeshire",
                            "Eglwyswrw":"Pembrokeshire",
                            "Tiers Cross":"Pembrokeshire",
                            "Letterston":"Pembrokeshire",
                            "Lampeter Velfrey":"Pembrokeshire",
                            "Martletwy":"Pembrokeshire",
                            "St Mary Out Liberty":"Pembrokeshire",
                            "Johnston":"Pembrokeshire",
                            "Tenby":"Pembrokeshire",
                            "Slebech":"Pembrokeshire",
                            "Cwm Gwaun":"Pembrokeshire",
                            "Merlins Bridge":"Pembrokeshire",
                            "Llanddewi Velfrey":"Pembrokeshire",
                            "Crymych":"Pembrokeshire",
                            "Narberth":"Pembrokeshire",
                            "Wiston":"Pembrokeshire",
                            "Castlemartin":"Pembrokeshire",
                            "Milford Haven":"Pembrokeshire",
                            "Clydau":"Pembrokeshire",
                            "Newport":"Pembrokeshire",
                            "Crymych":"Pembrokeshire",
                            "Cilgerran":"Pembrokeshire",
                            "Camrose":"Pembrokeshire",
                            "Carew":"Pembrokeshire",
                            "Neyland":"Pembrokeshire",
                            "Nevern":"Pembrokeshire",
                            "Llandissilio West":"Pembrokeshire",
                            "Manordeifi":"Pembrokeshire",
                            "Dale":"Pembrokeshire",
                            "Marloes and St Brides":"Pembrokeshire",
                            "Dinas Cross":"Pembrokeshire",
                            "Clydau":"Pembrokeshire",
                            "Cilgerran":"Pembrokeshire",
                            "Martletwy":"Pembrokeshire",
                            "Carew":"Pembrokeshire",
                            "Scleddau":"Pembrokeshire",
                            "Rosemarket":"Pembrokeshire",
                            "Manorbier":"Pembrokeshire",
                            "Mathry":"Pembrokeshire",
                            "Llangwm (Pembrokeshire)":"Pembrokeshire",
                            "Cosheston":"Pembrokeshire",
                            "Saundersfoot":"Pembrokeshire",
                            "Wolfscastle":"Pembrokeshire",
                            "Cwm Gwaun":"Pembrokeshire",
                            "Burton":"Pembrokeshire",
                            "Camrose":"Pembrokeshire",
                            "Trecwn":"Pembrokeshire",
                            "Castlemartin":"Pembrokeshire",
                            "Eglwyswrw":"Pembrokeshire",
                            "Llawhaden":"Pembrokeshire",
                            "Llanrhian":"Pembrokeshire",
                            "Dale":"Pembrokeshire",
                            "New Moat":"Pembrokeshire",
                            "Nolton and Roch":"Pembrokeshire",
                            "Rudbaxton":"Pembrokeshire",
                            "East Williamston":"Pembrokeshire",
                            "Maenclochog":"Pembrokeshire",
                            "Brawdy":"Pembrokeshire",
                            "Llangwm (Pembrokeshire)":"Pembrokeshire",
                            "Dinas Cross":"Pembrokeshire",
                            "Cosheston":"Pembrokeshire",
                            "Burton":"Pembrokeshire",
                            "Llanstadwell":"Pembrokeshire",
                            "Melindwr":"Ceredigion",
                            "Y Ferwig":"Ceredigion",
                            "Penbryn":"Ceredigion",
                            "Llanbadarn Fawr (Ceredigion)":"Ceredigion",
                            "Tirymynach":"Ceredigion",
                            "Llangwyryfon":"Ceredigion",
                            "Y Ferwig":"Ceredigion",
                            "Trawsgoed":"Ceredigion",
                            "Ysbyty Ystwyth":"Ceredigion",
                            "Lampeter":"Ceredigion",
                            "Lledrod":"Ceredigion",
                            "Faenor":"Ceredigion",
                            "Ysgubor-y-coed":"Ceredigion",
                            "Ystrad Fflur":"Ceredigion",
                            "Ystrad Meurig":"Ceredigion",
                            "Llangrannog":"Ceredigion",
                            "Tirymynach":"Ceredigion",
                            "Llansantffraed":"Ceredigion",
                            "Llangynfelyn":"Ceredigion",
                            "Llangybi (Ceredigion)":"Ceredigion",
                            "Llanwnnen":"Ceredigion",
                            "Llangynfelyn":"Ceredigion",
                            "Llangeitho":"Ceredigion",
                            "Llanfarian":"Ceredigion",
                            "Llanwnnen":"Ceredigion",
                            "Troedyraur":"Ceredigion",
                            "Llanarth (Ceredigion)":"Ceredigion",
                            "Pontarfynach":"Ceredigion",
                            "Llangoedmor":"Ceredigion",
                            "Ysgubor-y-coed":"Ceredigion",
                            "Llanilar":"Ceredigion",
                            "Llanfair Clydogau":"Ceredigion",
                            "Llanwenog":"Ceredigion",
                            "Geneur Glyn":"Ceredigion",
                            "Llanddewi Brefi":"Ceredigion",
                            "Llanddewi Brefi":"Ceredigion",
                            "Tregaron":"Ceredigion",
                            "Dyffryn Arth":"Ceredigion",
                            "New Quay":"Ceredigion",
                            "Llangwyryfon":"Ceredigion",
                            "Llanfihangel Ystrad":"Ceredigion",
                            "Llangybi (Ceredigion)":"Ceredigion",
                            "Lampeter":"Ceredigion",
                            "Aberystwyth":"Ceredigion",
                            "Cardigan":"Ceredigion",
                            "Llanwenog":"Ceredigion",
                            "Penbryn":"Ceredigion",
                            "Llangrannog":"Ceredigion",
                            "Llanrhystyd":"Ceredigion",
                            "Llandysul":"Ceredigion",
                            "Cardigan":"Ceredigion",
                            "Ceulanamaesmawr":"Ceredigion",
                            "Llandyfriog":"Ceredigion",
                            "Blaenrheidol":"Ceredigion",
                            "Beulah":"Ceredigion",
                            "Geneur Glyn":"Ceredigion",
                            "Llanllwchaiarn":"Ceredigion",
                            "Henfynyw":"Ceredigion",
                            "Beulah":"Ceredigion",
                            "Aberaeron":"Ceredigion",
                            "Llandysiliogogo":"Ceredigion",
                            "Trawsgoed":"Ceredigion",
                            "New Quay":"Ceredigion",
                            "Llanllwchaiarn":"Ceredigion",
                            "Tregaron":"Ceredigion",
                            "Nantcwnlle":"Ceredigion",
                            "Borth":"Ceredigion",
                            "Llansantffraed":"Ceredigion",
                            "Faenor":"Ceredigion",
                            "Llanfihangel Ystrad":"Ceredigion",
                            "Aberaeron":"Ceredigion",
                            "Llanbadarn Fawr (Ceredigion)":"Ceredigion",
                            "Blaenrheidol":"Ceredigion",
                            "Llanfarian":"Ceredigion",
                            "Ciliau Aeron":"Ceredigion",
                            "Ystrad Fflur":"Ceredigion",
                            "Llanrhystyd":"Ceredigion",
                            "Llangeitho":"Ceredigion",
                            "Llanfair Clydogau":"Ceredigion",
                            "Borth":"Ceredigion",
                            "Llanarth (Ceredigion)":"Ceredigion",
                            "Nantcwnlle":"Ceredigion",
                            "Ysbyty Ystwyth":"Ceredigion",
                            "Aberporth":"Ceredigion",
                            "Llandyfriog":"Ceredigion",
                            "Aberporth":"Ceredigion",
                            "Llangoedmor":"Ceredigion",
                            "Ciliau Aeron":"Ceredigion",
                            "Ystrad Meurig":"Ceredigion",
                            "Aberystwyth":"Ceredigion",
                            "Trefeurig":"Ceredigion",
                            "Henfynyw":"Ceredigion",
                            "Troedyraur":"Ceredigion",
                            "Ceulanamaesmawr":"Ceredigion",
                            "Llandysul":"Ceredigion",
                            "Dyffryn Arth":"Ceredigion",
                            "Lledrod":"Ceredigion",
                            "Pontarfynach":"Ceredigion",
                            "Trefeurig":"Ceredigion",
                            "Llanilar":"Ceredigion",
                            "Melindwr":"Ceredigion",
                            "Llandysiliogogo":"Ceredigion",
                            "St Asaph":"Denbighshire",
                            "Ruthin":"Denbighshire",
                            "Rhuddlan":"Denbighshire",
                            "Llangollen":"Denbighshire",
                            "Llanferres":"Denbighshire",
                            "Rhyl":"Denbighshire",
                            "Trefnant":"Denbighshire",
                            "Llangynhafal":"Denbighshire",
                            "Llanfair Dyffryn Clwyd":"Denbighshire",
                            "Llanynys":"Denbighshire",
                            "Llandegla":"Denbighshire",
                            "Cefnmeiriadog":"Denbighshire",
                            "Llanferres":"Denbighshire",
                            "Llanelidan":"Denbighshire",
                            "Llandrillo":"Denbighshire",
                            "Llangollen":"Denbighshire",
                            "Clocaenog":"Denbighshire",
                            "Ruthin":"Denbighshire",
                            "Gwyddelwern":"Denbighshire",
                            "Tremeirchion":"Denbighshire",
                            "Llanynys":"Denbighshire",
                            "Llanrhaeadr-yng-nghinmeirch":"Denbighshire",
                            "Prestatyn":"Denbighshire",
                            "Corwen":"Denbighshire",
                            "Llandyrnog":"Denbighshire",
                            "St Asaph":"Denbighshire",
                            "Llantysilio":"Denbighshire",
                            "Llanbedr Dyffryn Clwyd":"Denbighshire",
                            "Henllan":"Denbighshire",
                            "Aberwheeler":"Denbighshire",
                            "Bodelwyddan":"Denbighshire",
                            "Betws Gwerfil Goch":"Denbighshire",
                            "Dyserth":"Denbighshire",
                            "Cwm (Denbighshire)":"Denbighshire",
                            "Nantglyn":"Denbighshire",
                            "Waen":"Denbighshire",
                            "Efenechtyd":"Denbighshire",
                            "Llanbedr Dyffryn Clwyd":"Denbighshire",
                            "Llanrhaeadr-yng-nghinmeirch":"Denbighshire",
                            "Nantglyn":"Denbighshire",
                            "Cyffylliog":"Denbighshire",
                            "Llandrillo":"Denbighshire",
                            "Corwen":"Denbighshire",
                            "Llanarmon-yn-ial":"Denbighshire",
                            "Bodfari":"Denbighshire",
                            "Waen":"Denbighshire",
                            "Gwyddelwern":"Denbighshire",
                            "Llanelidan":"Denbighshire",
                            "Cefnmeiriadog":"Denbighshire",
                            "Aberwheeler":"Denbighshire",
                            "Prestatyn":"Denbighshire",
                            "Bryneglwys":"Denbighshire",
                            "Henllan":"Denbighshire",
                            "Denbigh":"Denbighshire",
                            "Derwen":"Denbighshire",
                            "Clocaenog":"Denbighshire",
                            "Denbigh":"Denbighshire",
                            "Rhyl":"Denbighshire",
                            "Cynwyd":"Denbighshire",
                            "Cyffylliog":"Denbighshire",
                            "Llanarmon-yn-ial":"Denbighshire",
                            "Trefnant":"Denbighshire",
                            "Cwm (Denbighshire)":"Denbighshire",
                            "Betws Gwerfil Goch":"Denbighshire",
                            "Rhuddlan":"Denbighshire",
                            "Bryneglwys":"Denbighshire",
                            "Llantysilio":"Denbighshire",
                            "Cynwyd":"Denbighshire",
                            "Derwen":"Denbighshire",
                            "Tremeirchion":"Denbighshire",
                            "Bodfari":"Denbighshire",
                            "Llangynhafal":"Denbighshire",
                            "Efenechtyd":"Denbighshire",
                            "Llandyrnog":"Denbighshire",
                            "Llandegla":"Denbighshire",
                            "Llanfair Dyffryn Clwyd":"Denbighshire",
                            "Dyserth":"Denbighshire",
                            "Bodelwyddan":"Denbighshire",
                            "Llanelly":"Monmouthshire",
                            "Chepstow":"Monmouthshire",
                            "Abergavenny":"Monmouthshire",
                            "Shirenewton":"Monmouthshire",
                            "Mathern":"Monmouthshire",
                            "Llantilio Crossenny":"Monmouthshire",
                            "Raglan":"Monmouthshire",
                            "Llantilio Pertholey":"Monmouthshire",
                            "Abergavenny":"Monmouthshire",
                            "Portskewett":"Monmouthshire",
                            "Llangattock-vibon-avel":"Monmouthshire",
                            "Caldicot":"Monmouthshire",
                            "Portskewett":"Monmouthshire",
                            "Llangattock-vibon-avel":"Monmouthshire",
                            "Monmouth":"Monmouthshire",
                            "Llanarth (Monmouthshire)":"Monmouthshire",
                            "Gwehelog Fawr":"Monmouthshire",
                            "Gwehelog Fawr":"Monmouthshire",
                            "Caerwent":"Monmouthshire",
                            "Chepstow":"Monmouthshire",
                            "Goetre Fawr":"Monmouthshire",
                            "Grosmont":"Monmouthshire",
                            "Grosmont":"Monmouthshire",
                            "Llanhennock":"Monmouthshire",
                            "Llanover":"Monmouthshire",
                            "Llantrisant Fawr":"Monmouthshire",
                            "Caldicot":"Monmouthshire",
                            "Mathern":"Monmouthshire",
                            "St Arvans":"Monmouthshire",
                            "Goetre Fawr":"Monmouthshire",
                            "Raglan":"Monmouthshire",
                            "Usk":"Monmouthshire",
                            "Llantilio Pertholey":"Monmouthshire",
                            "Llanfoist Fawr":"Monmouthshire",
                            "Monmouth":"Monmouthshire",
                            "Llangwm (Monmouthshire)":"Monmouthshire",
                            "Crucorney":"Monmouthshire",
                            "Llantrisant Fawr":"Monmouthshire",
                            "Llantilio Crossenny":"Monmouthshire",
                            "Trellech United":"Monmouthshire",
                            "St Arvans":"Monmouthshire",
                            "Caerwent":"Monmouthshire",
                            "Llanarth (Monmouthshire)":"Monmouthshire",
                            "Llangybi (Monmouthshire)":"Monmouthshire",
                            "Tintern":"Monmouthshire",
                            "Devauden":"Monmouthshire",
                            "Usk":"Monmouthshire",
                            "Llanbadoc":"Monmouthshire",
                            "Crucorney":"Monmouthshire",
                            "Llanhennock":"Monmouthshire",
                            "Llanbadoc":"Monmouthshire",
                            "Llanover":"Monmouthshire",
                            "Devauden":"Monmouthshire",
                            "Llanelly":"Monmouthshire",
                            "Tintern":"Monmouthshire",
                            "Rogiet":"Monmouthshire",
                            "Magor with Undy":"Monmouthshire",
                            "Mitchel Troy":"Monmouthshire",
                            "Rogiet":"Monmouthshire",
                            "Mitchel Troy":"Monmouthshire",
                            "Trellech United":"Monmouthshire",
                            "Llanfoist Fawr":"Monmouthshire",
                            "Magor with Undy":"Monmouthshire",
                            "Llangybi (Monmouthshire)":"Monmouthshire",
                            "Shirenewton":"Monmouthshire",
                            "Llangwm (Monmouthshire)":"Monmouthshire",
                            "Quarter Bach":"Carmarthenshire",
                            "Eglwyscummin":"Carmarthenshire",
                            "Myddfai":"Carmarthenshire",
                            "Manordeilo and Salem":"Carmarthenshire",
                            "Llanfihangel Aberbythych":"Carmarthenshire",
                            "Cenarth":"Carmarthenshire",
                            "Carmarthen":"Carmarthenshire",
                            "Llandybie":"Carmarthenshire",
                            "Cefn Sidan":"Carmarthenshire",
                            "Llanfair-ar-y-bryn":"Carmarthenshire",
                            "Cwmamman":"Carmarthenshire",
                            "Newcastle Emlyn":"Carmarthenshire",
                            "Llandeilo":"Carmarthenshire",
                            "Cynwyl Gaeo":"Carmarthenshire",
                            "Cynwyl Elfed":"Carmarthenshire",
                            "Llanddowror":"Carmarthenshire",
                            "Ammanford":"Carmarthenshire",
                            "Newchurch and Merthyr":"Carmarthenshire",
                            "Llanddeusant":"Carmarthenshire",
                            "St Ishmael":"Carmarthenshire",
                            "Llanddarog":"Carmarthenshire",
                            "Laugharne Township":"Carmarthenshire",
                            "Llanboidy":"Carmarthenshire",
                            "Meidrim":"Carmarthenshire",
                            "Pontyberem":"Carmarthenshire",
                            "Llanarthney":"Carmarthenshire",
                            "Kidwelly":"Carmarthenshire",
                            "Llanedi":"Carmarthenshire",
                            "Abergwili":"Carmarthenshire",
                            "Llanllawddog":"Carmarthenshire",
                            "Cefn Sidan":"Carmarthenshire",
                            "Llanfihangel Rhos-y-corn":"Carmarthenshire",
                            "Cenarth":"Carmarthenshire",
                            "Llandovery":"Carmarthenshire",
                            "Betws (Carmarthenshire)":"Carmarthenshire",
                            "Llanybydder":"Carmarthenshire",
                            "Llangunnor":"Carmarthenshire",
                            "Ammanford":"Carmarthenshire",
                            "Llanegwad":"Carmarthenshire",
                            "Llangunnor":"Carmarthenshire",
                            "Llansadwrn":"Carmarthenshire",
                            "Bronwydd":"Carmarthenshire",
                            "Llangennech":"Carmarthenshire",
                            "Llanpumsaint":"Carmarthenshire",
                            "Llangeler":"Carmarthenshire",
                            "Llangyndeyrn":"Carmarthenshire",
                            "Llandyfaelog":"Carmarthenshire",
                            "Llandybie":"Carmarthenshire",
                            "Llanddeusant":"Carmarthenshire",
                            "Cynwyl Gaeo":"Carmarthenshire",
                            "Llangynin":"Carmarthenshire",
                            "Llanedi":"Carmarthenshire",
                            "Trimsaran":"Carmarthenshire",
                            "Talley":"Carmarthenshire",
                            "Dyffryn Cennen":"Carmarthenshire",
                            "Eglwyscummin":"Carmarthenshire",
                            "Pendine":"Carmarthenshire",
                            "Newchurch and Merthyr":"Carmarthenshire",
                            "Llanycrwys":"Carmarthenshire",
                            "Llanarthney":"Carmarthenshire",
                            "Pencarreg":"Carmarthenshire",
                            "Llangain":"Carmarthenshire",
                            "Llanfynydd (Carmarthenshire)":"Carmarthenshire",
                            "Gorslas":"Carmarthenshire",
                            "Kidwelly":"Carmarthenshire",
                            "Llangadog":"Carmarthenshire",
                            "Trelech":"Carmarthenshire",
                            "Newcastle Emlyn":"Carmarthenshire",
                            "Pontyberem":"Carmarthenshire",
                            "Llangain":"Carmarthenshire",
                            "Llanybydder":"Carmarthenshire",
                            "Llanfihangel Rhos-y-corn":"Carmarthenshire",
                            "Quarter Bach":"Carmarthenshire",
                            "Llanfihangel-ar-arth":"Carmarthenshire",
                            "Llanfynydd (Carmarthenshire)":"Carmarthenshire",
                            "Llanfihangel-ar-arth":"Carmarthenshire",
                            "Myddfai":"Carmarthenshire",
                            "Laugharne Township":"Carmarthenshire",
                            "Llangathen":"Carmarthenshire",
                            "Llanwinio":"Carmarthenshire",
                            "Llangathen":"Carmarthenshire",
                            "Pendine":"Carmarthenshire",
                            "Henllanfallteg":"Carmarthenshire",
                            "Llangadog":"Carmarthenshire",
                            "Bagillt":"Flintshire",
                            "Flint":"Flintshire",
                            "Mold":"Flintshire",
                            "Connahs Quay":"Flintshire",
                            "Halkyn":"Flintshire",
                            "Gwernaffield":"Flintshire",
                            "Mostyn":"Flintshire",
                            "Whitford":"Flintshire",
                            "Gwernymynydd":"Flintshire",
                            "Broughton and Bretton":"Flintshire",
                            "Hope":"Flintshire",
                            "Holywell":"Flintshire",
                            "Llanfynydd (Flintshire)":"Flintshire",
                            "Caerwys":"Flintshire",
                            "Higher Kinnerton":"Flintshire",
                            "Buckley":"Flintshire",
                            "Connahs Quay":"Flintshire",
                            "Treuddyn":"Flintshire",
                            "Mynydd Isa":"Flintshire",
                            "Nercwys":"Flintshire",
                            "Bagillt":"Flintshire",
                            "Hawarden":"Flintshire",
                            "Flint":"Flintshire",
                            "Queensferry":"Flintshire",
                            "Halkyn":"Flintshire",
                            "Nannerch":"Flintshire",
                            "Gwernymynydd":"Flintshire",
                            "Gwernaffield":"Flintshire",
                            "Trelawnyd and Gwaenysgor":"Flintshire",
                            "Penyffordd":"Flintshire",
                            "Brynford":"Flintshire",
                            "Hawarden":"Flintshire",
                            "Leeswood":"Flintshire",
                            "Northop Hall":"Flintshire",
                            "Treuddyn":"Flintshire",
                            "Broughton and Bretton":"Flintshire",
                            "Whitford":"Flintshire",
                            "Cilcain":"Flintshire",
                            "Nannerch":"Flintshire",
                            "Nercwys":"Flintshire",
                            "Brynford":"Flintshire",
                            "Northop":"Flintshire",
                            "Sealand":"Flintshire",
                            "Saltney":"Flintshire",
                            "Ysceifiog":"Flintshire",
                            "Llanasa":"Flintshire",
                            "Saltney":"Flintshire",
                            "Mynydd Isa":"Flintshire",
                            "Buckley":"Flintshire",
                            "Trelawnyd and Gwaenysgor":"Flintshire",
                            "Caerwys":"Flintshire",
                            "Shotton":"Flintshire",
                            "Mold":"Flintshire",
                            "Shotton":"Flintshire",
                            "Queensferry":"Flintshire",
                            "Mostyn":"Flintshire",
                            "Leeswood":"Flintshire",
                            "Higher Kinnerton":"Flintshire",
                            "Llanfynydd (Flintshire)":"Flintshire",
                            "Cilcain":"Flintshire",
                            "Penyffordd":"Flintshire",
                            "Northop Hall":"Flintshire",
                            "Llanasa":"Flintshire",
                            "Ysceifiog":"Flintshire",
                            "Holywell":"Flintshire",
                            "Northop":"Flintshire",
                            "Sealand":"Flintshire",
                            "Hope":"Flintshire",
                            "Cylch-y-garn":"Isle of Anglesey",
                            "Moelfre":"Isle of Anglesey",
                            "Rhoscolyn":"Isle of Anglesey",
                            "Tref Alaw":"Isle of Anglesey",
                            "Menai Bridge":"Isle of Anglesey",
                            "Mechell":"Isle of Anglesey",
                            "Holyhead":"Isle of Anglesey",
                            "Bryngwran":"Isle of Anglesey",
                            "Llanidan":"Isle of Anglesey",
                            "Llanddona":"Isle of Anglesey",
                            "Trewalchmai":"Isle of Anglesey",
                            "Llangoed":"Isle of Anglesey",
                            "Llanidan":"Isle of Anglesey",
                            "Llanddaniel Fab":"Isle of Anglesey",
                            "Valley":"Isle of Anglesey",
                            "Llangristiolus":"Isle of Anglesey",
                            "Llannerch-y-medd":"Isle of Anglesey",
                            "Llangristiolus":"Isle of Anglesey",
                            "Llangefni":"Isle of Anglesey",
                            "Llangoed":"Isle of Anglesey",
                            "Rhosyr":"Isle of Anglesey",
                            "Amlwch":"Isle of Anglesey",
                            "Bodorgan":"Isle of Anglesey",
                            "Bodedern":"Isle of Anglesey",
                            "Tref Alaw":"Isle of Anglesey",
                            "Cylch-y-garn":"Isle of Anglesey",
                            "Beaumaris":"Isle of Anglesey",
                            "Rhosybol":"Isle of Anglesey",
                            "Cwm Cadnant":"Isle of Anglesey",
                            "Aberffraw":"Isle of Anglesey",
                            "Llanbadrig":"Isle of Anglesey",
                            "Bodffordd":"Isle of Anglesey",
                            "Cwm Cadnant":"Isle of Anglesey",
                            "Llangefni":"Isle of Anglesey",
                            "Penmynydd":"Isle of Anglesey",
                            "Llanfaelog":"Isle of Anglesey",
                            "Amlwch":"Isle of Anglesey",
                            "Llanfachraeth":"Isle of Anglesey",
                            "Rhoscolyn":"Isle of Anglesey",
                            "Bodorgan":"Isle of Anglesey",
                            "Pentraeth":"Isle of Anglesey",
                            "Bodffordd":"Isle of Anglesey",
                            "Llaneugrad":"Isle of Anglesey",
                            "Bodedern":"Isle of Anglesey",
                            "Mechell":"Isle of Anglesey",
                            "Llanfaethlu":"Isle of Anglesey",
                            "Llanfihangel Ysgeifiog":"Isle of Anglesey",
                            "Llaneugrad":"Isle of Anglesey",
                            "Llanddona":"Isle of Anglesey",
                            "Llanddyfnan":"Isle of Anglesey",
                            "Beaumaris":"Isle of Anglesey",
                            "Holyhead":"Isle of Anglesey",
                            "Llaneilian":"Isle of Anglesey",
                            "Rhosyr":"Isle of Anglesey",
                            "Rhosybol":"Isle of Anglesey",
                            "Aberffraw":"Isle of Anglesey",
                            "Llanfair Pwllgwyngyll":"Isle of Anglesey",
                            "Moelfre":"Isle of Anglesey",
                            "Llaneilian":"Isle of Anglesey",
                            "Llanddaniel Fab":"Isle of Anglesey",
                            "Llanfair-mathafarn-eithaf":"Isle of Anglesey",
                            "Trearddur":"Isle of Anglesey",
                            "Llanfihangel Ysgeifiog":"Isle of Anglesey",
                            "Llanfair-yn-neubwll":"Isle of Anglesey",
                            "Llanddyfnan":"Isle of Anglesey",
                            "Llanfair-mathafarn-eithaf":"Isle of Anglesey",
                            "Menai Bridge":"Isle of Anglesey",
                            "Trearddur":"Isle of Anglesey",
                            "Pentraeth":"Isle of Anglesey",
                            "Llanfair Pwllgwyngyll":"Isle of Anglesey",
                            "Llannerch-y-medd":"Isle of Anglesey",
                            "Llanfachraeth":"Isle of Anglesey",
                            "Llanbadrig":"Isle of Anglesey",
                            "Llanfair-yn-neubwll":"Isle of Anglesey",
                            "Llanfaelog":"Isle of Anglesey",
                            "Trewalchmai":"Isle of Anglesey",
                            "Penmynydd":"Isle of Anglesey",
                            "Valley":"Isle of Anglesey",
                            "Bryngwran":"Isle of Anglesey",
                            "Llanfaethlu":"Isle of Anglesey",
                            "Abersychan":"Torfaen",
                            "Pontymoile":"Torfaen",
                            "Henllys":"Torfaen",
                            "Llanyrafon":"Torfaen",
                            "Llantarnam":"Torfaen",
                            "Ponthir":"Torfaen",
                            "Pen Tranch":"Torfaen",
                            "Pontnewydd":"Torfaen",
                            "Upper Cwmbran":"Torfaen",
                            "Blaenavon":"Torfaen",
                            "Llantarnam":"Torfaen",
                            "Panteg":"Torfaen",
                            "New Inn":"Torfaen",
                            "Croesyceiliog":"Torfaen",
                            "Henllys":"Torfaen",
                            "Trevethin":"Torfaen",
                            "Fairwater (Torfaen)":"Torfaen",
                            "Cwmbran Central":"Torfaen",
                            "Croesyceiliog":"Torfaen",
                            "Abersychan":"Torfaen",
                            "Panteg":"Torfaen",
                            "Cwmbran Central":"Torfaen",
                            "Upper Cwmbran":"Torfaen",
                            "New Inn":"Torfaen",
                            "Blaenavon":"Torfaen",
                            "Fairwater (Torfaen)":"Torfaen",
                            "Ponthir":"Torfaen",
                            "Pen Tranch":"Torfaen",
                            "Pontymoile":"Torfaen",
                            "Trevethin":"Torfaen",
                            "Pontnewydd":"Torfaen",
                            "Llanyrafon":"Torfaen",
                            "Hanmer":"Wrexham",
                            "Brymbo":"Wrexham",
                            "Marchwiel":"Wrexham",
                            "Acton":"Wrexham",
                            "Maelor South":"Wrexham",
                            "Holt":"Wrexham",
                            "Penycae":"Wrexham",
                            "Gwersyllt":"Wrexham",
                            "Rhosddu":"Wrexham",
                            "Overton":"Wrexham",
                            "Rhosllanerchrugog":"Wrexham",
                            "Abenbury":"Wrexham",
                            "Broughton":"Wrexham",
                            "Offa":"Wrexham",
                            "Rossett":"Wrexham",
                            "Ruabon":"Wrexham",
                            "Bangor Is-y-coed":"Wrexham",
                            "Sesswick":"Wrexham",
                            "Sesswick":"Wrexham",
                            "Bronington":"Wrexham",
                            "Penycae":"Wrexham",
                            "Minera":"Wrexham",
                            "Llay":"Wrexham",
                            "Willington Worthenbury":"Wrexham",
                            "Glyntraian":"Wrexham",
                            "Isycoed":"Wrexham",
                            "Esclusham":"Wrexham",
                            "Gresford":"Wrexham",
                            "Erbistock":"Wrexham",
                            "Brymbo":"Wrexham",
                            "Isycoed":"Wrexham",
                            "Erbistock":"Wrexham",
                            "Rossett":"Wrexham",
                            "Esclusham":"Wrexham",
                            "Minera":"Wrexham",
                            "Coedpoeth":"Wrexham",
                            "Ceiriog Ucha":"Wrexham",
                            "Gwersyllt":"Wrexham",
                            "Rhosllanerchrugog":"Wrexham",
                            "Llansantffraid Glyn Ceiriog":"Wrexham",
                            "Cefn":"Wrexham",
                            "Broughton":"Wrexham",
                            "Chirk":"Wrexham",
                            "Holt":"Wrexham",
                            "Abenbury":"Wrexham",
                            "Bronington":"Wrexham",
                            "Llangollen Rural":"Wrexham",
                            "Acton":"Wrexham",
                            "Hanmer":"Wrexham",
                            "Overton":"Wrexham",
                            "Caia Park":"Wrexham",
                            "Chirk":"Wrexham",
                            "Marchwiel":"Wrexham",
                            "Glyntraian":"Wrexham",
                            "Maelor South":"Wrexham",
                            "Ceiriog Ucha":"Wrexham",
                            "Bangor Is-y-coed":"Wrexham",
                            "Cefn":"Wrexham",
                            "Llay":"Wrexham",
                            "Llangollen Rural":"Wrexham",
                            "Coedpoeth":"Wrexham",
                            "Caia Park":"Wrexham",
                            "Rhosddu":"Wrexham",
                            "Offa":"Wrexham",
                            "Willington Worthenbury":"Wrexham",
                            "Llansantffraid Glyn Ceiriog":"Wrexham",
                            "Ruabon":"Wrexham",
                            "Gresford":"Wrexham",
                            "Maerdy":"Rhondda Cynon Taff",
                            "Tylorstown":"Rhondda Cynon Taff",
                            "Cwmbach":"Rhondda Cynon Taff",
                            "Llantrisant":"Rhondda Cynon Taff",
                            "Cymmer":"Rhondda Cynon Taff",
                            "Cwm Clydach":"Rhondda Cynon Taff",
                            "Cwm Clydach":"Rhondda Cynon Taff",
                            "Treorchy":"Rhondda Cynon Taff",
                            "Pen-y-waun":"Rhondda Cynon Taff",
                            "Trehafod":"Rhondda Cynon Taff",
                            "Llantwit Fardre":"Rhondda Cynon Taff",
                            "Pontypridd":"Rhondda Cynon Taff",
                            "Treherbert":"Rhondda Cynon Taff",
                            "Ynysybwl and Coed-y-cwm":"Rhondda Cynon Taff",
                            "Tonyrefail":"Rhondda Cynon Taff",
                            "Llwyn-y-pia":"Rhondda Cynon Taff",
                            "Llwydcoed":"Rhondda Cynon Taff",
                            "Tonypandy":"Rhondda Cynon Taff",
                            "Ferndale":"Rhondda Cynon Taff",
                            "Taffs Well":"Rhondda Cynon Taff",
                            "Tonyrefail":"Rhondda Cynon Taff",
                            "Tonypandy":"Rhondda Cynon Taff",
                            "Trealaw":"Rhondda Cynon Taff",
                            "Hirwaun":"Rhondda Cynon Taff",
                            "Mountain Ash":"Rhondda Cynon Taff",
                            "Ferndale":"Rhondda Cynon Taff",
                            "Rhigos":"Rhondda Cynon Taff",
                            "Gilfach Goch":"Rhondda Cynon Taff",
                            "Trehafod":"Rhondda Cynon Taff",
                            "Trealaw":"Rhondda Cynon Taff",
                            "Mountain Ash":"Rhondda Cynon Taff",
                            "Porth":"Rhondda Cynon Taff",
                            "Pen-y-graig":"Rhondda Cynon Taff",
                            "Aberdare":"Rhondda Cynon Taff",
                            "Llanharan":"Rhondda Cynon Taff",
                            "Aberaman":"Rhondda Cynon Taff",
                            "Ynyshir":"Rhondda Cynon Taff",
                            "Pen-y-graig":"Rhondda Cynon Taff",
                            "Pen-y-waun":"Rhondda Cynon Taff",
                            "Ystrad":"Rhondda Cynon Taff",
                            "Llanharry":"Rhondda Cynon Taff",
                            "Cymmer":"Rhondda Cynon Taff",
                            "Ynysybwl and Coed-y-cwm":"Rhondda Cynon Taff",
                            "Abernant":"Carmarthenshire",
                            "Llanelli Rural":"Carmarthenshire",
                            "Llanelli":"Carmarthenshire",
                            "Dyffryn Cennen":"Carmarthenshire",
                            "Gorslas":"Carmarthenshire",
                            "Llandovery":"Carmarthenshire",
                            "Betws (Carmarthenshire)":"Carmarthenshire",
                            "Clynderwen":"Carmarthenshire",
                            "Cilycwm":"Carmarthenshire",
                            "Cilymaenllwyd":"Carmarthenshire",
                            "Bronwydd":"Carmarthenshire",
                            "St Clears":"Carmarthenshire",
                            "Llandyfaelog":"Carmarthenshire",
                            "Henllanfallteg":"Carmarthenshire",
                            "Pencarreg":"Carmarthenshire",
                            "Llanegwad":"Carmarthenshire",
                            "Llanllawddog":"Carmarthenshire",
                            "St Clears":"Carmarthenshire",
                            "Llansadwrn":"Carmarthenshire",
                            "Llanboidy":"Carmarthenshire",
                            "Llansawel":"Carmarthenshire",
                            "Llangeler":"Carmarthenshire",
                            "Llanpumsaint":"Carmarthenshire",
                            "Llansawel":"Carmarthenshire",
                            "Llanllwni":"Carmarthenshire",
                            "Whitland":"Carmarthenshire",
                            "Llangennech":"Carmarthenshire",
                            "Abergwili":"Carmarthenshire",
                            "Abernant":"Carmarthenshire",
                            "Llanelli Rural":"Carmarthenshire",
                            "Llanddarog":"Carmarthenshire",
                            "Llanelli":"Carmarthenshire",
                            "Llannon":"Carmarthenshire",
                            "Trelech":"Carmarthenshire",
                            "Whitland":"Carmarthenshire",
                            "Llanfihangel Aberbythych":"Carmarthenshire",
                            "Llanwrda":"Carmarthenshire",
                            "St Ishmael":"Carmarthenshire",
                            "Talley":"Carmarthenshire",
                            "Llanwinio":"Carmarthenshire",
                            "Llansteffan":"Carmarthenshire",
                            "Llanfair-ar-y-bryn":"Carmarthenshire",
                            "Llangyndeyrn":"Carmarthenshire",
                            "Manordeilo and Salem":"Carmarthenshire",
                            "Trimsaran":"Carmarthenshire",
                            "Llanycrwys":"Carmarthenshire",
                            "Cilycwm":"Carmarthenshire",
                            "Llanwrda":"Carmarthenshire",
                            "Llansteffan":"Carmarthenshire",
                            "Meidrim":"Carmarthenshire",
                            "Cilymaenllwyd":"Carmarthenshire",
                            "Cwmamman":"Carmarthenshire",
                            "Llangynin":"Carmarthenshire",
                            "Llangynog (Carmarthenshire)":"Carmarthenshire",
                            "Llannon":"Carmarthenshire",
                            "Llanddowror":"Carmarthenshire",
                            "Clynderwen":"Carmarthenshire",
                            "Llangynog (Carmarthenshire)":"Carmarthenshire",
                            "Carmarthen":"Carmarthenshire",
                            "Cynwyl Elfed":"Carmarthenshire",
                            "Llanllwni":"Carmarthenshire",
                            "Llandeilo":"Carmarthenshire",
                            "Treherbert":"Rhondda Cynon Taff",
                            "Ynyshir":"Rhondda Cynon Taff",
                            "Pont-y-clun":"Rhondda Cynon Taff",
                            "Cwmbach":"Rhondda Cynon Taff",
                            "Abercynon":"Rhondda Cynon Taff",
                            "Pentre":"Rhondda Cynon Taff",
                            "Rhigos":"Rhondda Cynon Taff",
                            "Pontypridd":"Rhondda Cynon Taff",
                            "Penrhiwceiber":"Rhondda Cynon Taff",
                            "Aberdare":"Rhondda Cynon Taff",
                            "Llanharan":"Rhondda Cynon Taff",
                            "Penrhiwceiber":"Rhondda Cynon Taff",
                            "Llanharry":"Rhondda Cynon Taff",
                            "Hirwaun":"Rhondda Cynon Taff",
                            "Llwyn-y-pia":"Rhondda Cynon Taff",
                            "Aberaman":"Rhondda Cynon Taff",
                            "Abercynon":"Rhondda Cynon Taff",
                            "Tylorstown":"Rhondda Cynon Taff",
                            "Ystrad":"Rhondda Cynon Taff",
                            "Pentre":"Rhondda Cynon Taff",
                            "Taffs Well":"Rhondda Cynon Taff",
                            "Llwydcoed":"Rhondda Cynon Taff",
                            "Porth":"Rhondda Cynon Taff",
                            "Llantrisant":"Rhondda Cynon Taff",
                            "Llantwit Fardre":"Rhondda Cynon Taff",
                            "Pont-y-clun":"Rhondda Cynon Taff",
                            "Gilfach Goch":"Rhondda Cynon Taff",
                            "Maerdy":"Rhondda Cynon Taff",
                            "Treorchy":"Rhondda Cynon Taff",
                            "Blaenhonddan":"Neath Port Talbot",
                            "Blaengwrach":"Neath Port Talbot",
                            "Margam Moors":"Neath Port Talbot",
                            "Baglan":"Neath Port Talbot",
                            "Glyncorrwg":"Neath Port Talbot",
                            "Glyncorrwg":"Neath Port Talbot",
                            "Margam":"Neath Port Talbot",
                            "Cwmllynfell":"Neath Port Talbot",
                            "Cwmllynfell":"Neath Port Talbot",
                            "Tai Bach":"Neath Port Talbot",
                            "Neath":"Neath Port Talbot",
                            "Aberavon":"Neath Port Talbot",
                            "Dyffryn Clydach":"Neath Port Talbot",
                            "Clyne and Melincourt":"Neath Port Talbot",
                            "Coedffranc":"Neath Port Talbot",
                            "Cwmavon":"Neath Port Talbot",
                            "Bryn":"Neath Port Talbot",
                            "Glynneath":"Neath Port Talbot",
                            "Gwaun-cae-gurwen":"Neath Port Talbot",
                            "Baglan Bay":"Neath Port Talbot",
                            "Crynant":"Neath Port Talbot",
                            "Cwmavon":"Neath Port Talbot",
                            "Briton Ferry":"Neath Port Talbot",
                            "Crynant":"Neath Port Talbot",
                            "Resolven":"Neath Port Talbot",
                            "Tai Bach":"Neath Port Talbot",
                            "Port Talbot":"Neath Port Talbot",
                            "Sandfields East":"Neath Port Talbot",
                            "Sandfields West":"Neath Port Talbot",
                            "Seven Sisters":"Neath Port Talbot",
                            "Pelenna":"Neath Port Talbot",
                            "Tonna":"Neath Port Talbot",
                            "Pontardawe":"Neath Port Talbot",
                            "Neath":"Neath Port Talbot",
                            "Ystalyfera":"Neath Port Talbot",
                            "Blaenhonddan":"Neath Port Talbot",
                            "Sandfields East":"Neath Port Talbot",
                            "Sandfields West":"Neath Port Talbot",
                            "Bryn":"Neath Port Talbot",
                            "Tonna":"Neath Port Talbot",
                            "Margam Moors":"Neath Port Talbot",
                            "Onllwyn":"Neath Port Talbot",
                            "Margam":"Neath Port Talbot",
                            "Briton Ferry":"Neath Port Talbot",
                            "Resolven":"Neath Port Talbot",
                            "Glynneath":"Neath Port Talbot",
                            "Baglan Bay":"Neath Port Talbot",
                            "Dyffryn Clydach":"Neath Port Talbot",
                            "Baglan":"Neath Port Talbot",
                            "Gwaun-cae-gurwen":"Neath Port Talbot",
                            "Coedffranc":"Neath Port Talbot",
                            "Pelenna":"Neath Port Talbot",
                            "Ystalyfera":"Neath Port Talbot",
                            "Onllwyn":"Neath Port Talbot",
                            "Pontardawe":"Neath Port Talbot",
                            "Clyne and Melincourt":"Neath Port Talbot",
                            "Port Talbot":"Neath Port Talbot",
                            "Cilybebyll":"Neath Port Talbot",
                            "Aberavon":"Neath Port Talbot",
                            "Seven Sisters":"Neath Port Talbot",
                            "Blaengwrach":"Neath Port Talbot",
                            "Cilybebyll":"Neath Port Talbot",
                            "Maritime":"Maritime",
                            "Maritime":"Maritime",

                        }
                      },
    "classname": "UnitaryFunction",
    "component": "views/components/functions/generate_node_value",
}

#Methods
def createNewTile(keys, source_tile):
    '''
    Description:
    Creates a new Unitary Authority tile 
    
    Parameters:
    :source_tile: Triggering tile
    
    Returns:
    :target_tile: Returns a new tile with all required data
    '''
    
    #Nodes
    unitary_authority = '86e99f1a-9327-11ec-8b2f-00155d9326d1' #Unitary Authority nodegroup uuid
    ua_value = "7f638dc0-93cf-11ec-a178-00155d9326d1" #Unitary Authority's node uuid
    
    #UUID's for the right side of the default.config.keys dictionary 
    rhs_key = source_tile.data[list(source_tile.data.keys())[0]] #Always fetch the first element as only one value can be selected
    
    #Request new blank tile of resource instance from unitary authority
    target_tile = Tile().get_blank_tile_from_nodegroup_id(unitary_authority, source_tile.resourceinstance_id)
    
    #Add UA data to new tile
    target_tile.data[ua_value] = keys[rhs_key]

    return target_tile

def getConcepts(self):
    '''
    Description:
    This functions takes a word dictionary and convert it to UUID dictionary
    
    Parameters:
    'source_thesauri_id': Left hand thesauri  of the default config keys
    'target_thesauri_id': Right hand thesauri of th default config keys
    
    Returns:
    'new_keys': Returns the original dictionary with words converted to UUID's
    '''
    #source_thesauri_id
    source_thesauri_id = "6718532c-1bf4-41e0-9243-ff605a6bf168" # to be changed  community value thesauri uuid
    target_thesauri_id = "691be2ee-a3fc-4b38-be2d-7752e5f4d927" # to be changed unitary authority thesauri uuid
    
    new_keys = {}

    #Left hand side of default config keys
    source_thesauri = Concept().get(
        id=source_thesauri_id,
        include_subconcepts=True,
        include_parentconcepts=False,
        include_relatedconcepts=True,
        depth_limit=None,
        up_depth_limit=None,
    )

    #Right hand side of default config keys
    target_thesauri = Concept().get(
        id=target_thesauri_id,
        include_subconcepts=True,
        include_parentconcepts=False,
        include_relatedconcepts=True,
        depth_limit=None,
        up_depth_limit=None,
    )
    

    for source_subc in source_thesauri.subconcepts: # for each concept in left hand thesauri
        for target_subc in target_thesauri.subconcepts:# for each concept in right hand thesauri 
            if target_subc.values[0].value == self.config['keys'][source_subc.values[0].value]: # check whether left hand concept(text) matches default config keys
                new_keys[source_subc.values[0].id] = target_subc.values[0].id # If match create a new key with lef hand concept UUID and right hand concept UUID
                
    return new_keys

#TODO: Stop it form triggering twice 

class UnitaryFunction(BaseFunction):

    def save(self, tile, request):
        #Get concept UUIDs from word values
        self.config['keys'] = getConcepts(self)
        
        #Variables
        source_tile = tile
        print(f'srouce tile: {vars(source_tile)}')
        exists = False

        #Create target tile 
        target_tile = createNewTile(self.config['keys'], source_tile)
        
        #Check if source_tile has one or more target tiles 
        if Tile.objects.filter(resourceinstance_id = source_tile.resourceinstance_id, nodegroup_id = target_tile.nodegroup_id).exists():
            #if true called all instances of target tile 
            target_tiles = Tile.objects.filter(resourceinstance_id = source_tile.resourceinstance_id, nodegroup_id = target_tile.nodegroup)
            
            #For each tile check if Unitary Authority tile already exists
            for tile in target_tiles:
                if str(tile.nodegroup_id) == '86e99f1a-9327-11ec-8b2f-00155d9326d1': #Unitary Authority 
                    #If so remove it and add the new one, since there can only be one
                    tile.delete()
                    target_tile.save()
                    return

        #If no target tiles exist just save a new tile   
        if not exists:
            target_tile.save()
            
        return
                
